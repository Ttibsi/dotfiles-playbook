---

- name: Clone repo
  git:
    clone: yes
    dest: "{{ home_dir }}/Downloads/alacritty"
    repo: https://github.com/alacritty/alacritty.git

- name: Install rust
  command: curl https://sh.rustup.rs -sSf | sh

- name: Install dependancies
  apt:
    name:
      - cmake 
      - pkg-config 
      - libfreetype6-dev 
      - libfontconfig1-dev 
      - libxcb-xfixes0-dev 
      - libxkbcommon-dev
  become: yes

- name: Build
  command: "cargo build --manifest-path {{ home_dir }}/Downloads/alacritty/cargo.toml --release"

- name: Copy executable
  copy:
    src: "{{ home_dir}}/Downloads/alacritty/target/release/alacritty"
    dest: /usr/local/bin 
  become: yes

- name: Copy alacritty logo
  copy:
    src: "{{ home_dir}}/Downloads/alacritty/extra/logo/alacritty-term.svg"
    dest: /usr/share/pixmaps/Alacritty.svg
  become: yes

- name: Install logo 
  command: desktop-file-install extra/linux/Alacritty.desktop
  become: yes

- name: Update desktop database
  command: update-desktop-database
  become: yes

- name: Move config file
  copy:
    src: templates/alacritty-config/alacritty.yml
    dest: "{{ home_dir }}/.alacritty.yml"

